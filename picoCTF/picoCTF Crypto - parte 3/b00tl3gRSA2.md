## Descripción del reto
In RSA d is a lot bigger than e, why don't we use d to encrypt instead of e? Connect with `nc jupiter.challenges.picoctf.org 57464`.

## Solución

```bash
┌──(kali㉿kali)-[~/picoCTF/crypto/parte-3]
└─$ nc jupiter.challenges.picoctf.org 57464
c: 83357120713837345163309102617639560150526482266949467582087808814972114622365651578677501392827186849095854872275160045332717638757159049354383423230408887834705770937982631955777083526812399120275536507303810518416653345029687579411369576976711010379443246664064320174962388563690584617628420562717870647612
n: 93872162769955714847294736821473296922665186232607719290999873843040773273605520884316538321925028243303509947808088498770239287550179808405201869454024601999485492194578372273846056201331678226007744071753311318242234082578726537365481546381186056300632810317642126245725240619107269047077479537045001291609
e: 73217622782730766984286205686913507160777519945255486015503311888470866951903404352405640926527635819658292537072280693221208197837901357496508902770669615014112954034477916425080030433524585426314409709924665746030223468369016892240941933308803929858617178557586547987612606043274968159729552069309191594533

```

``` python
def isqrt(n):
if n == 0:
	return 0
	x = 2 ** ((n.bit_length() + 1) // 2)
while True:
	y = (x + n // x) // 2
if y >= x:
	return x
	x = y

def is_perfect_square(n):
	sq_mod256 =(1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0)

if sq_mod256[n & 0xff] == 0:
	return False
	mt = ((9, (1,1,0,0,1,0,0,1,0)),(5, (1,1,0,0,1)),(7, (1,1,1,0,1,0,0)),(13, (1,1,0,1,1,0,0,0,0,1,1,0,1)),(17, (1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,1,1))
)

a = n % (9 * 5 * 7 * 13 * 17)

if any(t[a % m] == 0 for m, t in mt):

return False

return isqrt(n) ** 2 == n

  

def rational_to_contfrac(x, y):

while y:

a = x // y

yield a

x, y = y, x - a * y

  

def contfrac_to_rational_iter(contfrac):

n0, d0 = 0, 1

n1, d1 = 1, 0

for q in contfrac:

n = q * n1 + n0

d = q * d1 + d0

yield n, d

n0, d0 = n1, d1

n1, d1 = n, d

  

def convergents_from_contfrac(contfrac):

n_, d_ = 1, 0

for i, (n, d) in enumerate(contfrac_to_rational_iter(contfrac)):

if i % 2 == 0:

yield n + n_, d + d_

else:

yield n, d

n_, d_ = n, d

  

def attack(e, n):

f_ = rational_to_contfrac(e, n)

for k, dg in convergents_from_contfrac(f_):

edg = e * dg

phi = edg // k

x = n - phi + 1

if x % 2 == 0 and is_perfect_square((x // 2) ** 2 - n):

g = edg - phi * k

return dg // g

return None

  

e = 73217622782730766984286205686913507160777519945255486015503311888470866951903404352405640926527635819658292537072280693221208197837901357496508902770669615014112954034477916425080030433524585426314409709924665746030223468369016892240941933308803929858617178557586547987612606043274968159729552069309191594533

n=93872162769955714847294736821473296922665186232607719290999873843040773273605520884316538321925028243303509947808088498770239287550179808405201869454024601999485492194578372273846056201331678226007744071753311318242234082578726537365481546381186056300632810317642126245725240619107269047077479537045001291609

d=attack(e, n)

c=83357120713837345163309102617639560150526482266949467582087808814972114622365651578677501392827186849095854872275160045332717638757159049354383423230408887834705770937982631955777083526812399120275536507303810518416653345029687579411369576976711010379443246664064320174962388563690584617628420562717870647612

m=pow(c,d,n)

print(m.to_bytes(m.bit_length(), byteorder='big'))
```

```bash
┌──(kali㉿kali)-[~/Desktop]
└─$ /bin/python /home/kali/picoCTF/crypto/parte-3/asd.py
b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00picoCTF{bad_1d3a5_2152720}'
```

picoCTF{bad_1d3a5_2152720}
## Notas


## Referencia
## Descripción del reto
We received an encrypted message. The modulus is built from primes large enough that factoring them isn’t an option, at least not today. See if you can make sense of the numbers and reveal the flag.Download the [message](https://challenge-files.picoctf.net/c_amiable_citadel/17844e1db2c883adfc82f6601dfed7514cfbfce479cf0f0e63b32abb4aab8fc5/message.txt).

## Solución

```
BLOODANGELIX-picoctf@webshell:~$ wget https://challenge-files.picoctf.net/c_amiable_citadel/17844e1db2c883adfc82f6601dfed7514cfbfce479cf0f0e63b32abb4aab8fc5/message.txt
--2025-11-06 19:18:31--  https://challenge-files.picoctf.net/c_amiable_citadel/17844e1db2c883adfc82f6601dfed7514cfbfce479cf0f0e63b32abb4aab8fc5/message.txt
Resolving challenge-files.picoctf.net (challenge-files.picoctf.net)... 3.160.5.95, 3.160.5.40, 3.160.5.64, ...
Connecting to challenge-files.picoctf.net (challenge-files.picoctf.net)|3.160.5.95|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2399 (2.3K) [application/octet-stream]
Saving to: 'message.txt'

message.txt                    100%[====================================================>]   2.34K  --.-KB/s    in 0s      

2025-11-06 19:18:31 (624 MB/s) - 'message.txt' saved [2399/2399]

BLOODANGELIX-picoctf@webshell:~$ cat message.txt 
n = 868388982954131201479963675116137612306992896931272617790513066556054418385207570465450595178413774521539493802938525765839291743456344768808428636816274400852392320860469533635241549121846846199955510532198098119167528152693459663605037848666870525701692667502850484359781291856644176292197138239603813116840128440306439065322574973363097099549539442315147497941432804041389454127274300788599416072900874297262003829764501263681911221994313807470328171814767681088234884400764167084367618084182089811487512983306062393708062187780486140875125690276782346088928945047889289713307769452632645497363290366369957934147829202620228493827193161345988126450320024565706272154093286593649360213197021295549516042865867014967897628114486174184112945692325990601017009967163490031912929822607208773248838840621383601867990479185600880801724129847611545443200313393393331742474849699051808518315424346276583324110013044159114033158529839416912817446073242317289770726833743740150678123571942666688902937522148720462779922609053693463313194254069095096898942524026182770927590799764591872649173307854976286442930483777056989238423015281874011874176751039270361335481284717486194121913363398514721455342093446709010770978184665922685829007633417
e = 20
c = 640637430810406857500566702096274083827969484683203431057884917289334852774628366544173898461793872749381218755789561147579616430654545910443392999745646991166871881921220464939864253713908416530390190158949384932577913862830219713857369609459762011889417419756793122426703825117513400191620385907288504916090847305768659601562703145161353515226108384753106940659543471151834612884216177615674237258524708660356029782277496502661375640482568436495365098768844463148890142800375234779194361829383863910733638511522447466825092214583332860815273048698909839939639414519049464503518148811430663951050780377349263954109578307275120668187576579606920834997300457959369210342979008781474779797263684804038193343559153360000591890914138162679452520178353221126345668053628984789866309647708241703704572876397093327331829759682103901466789622570329436397304004981624979326705982863341122172795333419091029054076901225961700895404005870959370534342030325042659771283312708045031896875418423823654636664200180485341848613950104499288108479732463452304383581012867506699521685887270123864182790207674665585641962611326611636762153910224157810233669579162854801
BLOODANGELIX-picoctf@webshell:~$ nano script.py
```

```python
def integer_nth_root(a, n):
    if a < 0:
        raise ValueError("a must be non-negative")
    if a == 0:
        return 0, True
    high = 1 << ((a.bit_length() + n - 1) // n)
    low = 0
    while low < high:
        mid = (low + high) // 2
        p = mid ** n
        if p == a:
            return mid, True
        if p < a:
            low = mid + 1
        else:
            high = mid
    root = low - 1
    return root, root ** n == a

n = 868388982954131201479963675116137612306992896931272617790513066556054418385207570465450595178413774521539493802938525765839291743456344768808428636816274400852392320860469533635241549121846846199955510532198098119167528152693459663605037848666870525701692667502850484359781291856644176292197138239603813116840128440306439065322574973363097099549539442315147497941432804041389454127274300788599416072900874297262003829764501263681911221994313807470328171814767681088234884400764167084367618084182089811487512983306062393708062187780486140875125690276782346088928945047889289713307769452632645497363290366369957934147829202620228493827193161345988126450320024565706272154093286593649360213197021295549516042865867014967897628114486174184112945692325990601017009967163490031912929822607208773248838840621383601867990479185600880801724129847611545443200313393393331742474849699051808518315424346276583324110013044159114033158529839416912817446073242317289770726833743740150678123571942666688902937522148720462779922609053693463313194254069095096898942524026182770927590799764591872649173307854976286442930483777056989238423015281874011874176751039270361335481284717486194121913363398514721455342093446709010770978184665922685829007633417
e = 20
c = 640637430810406857500566702096274083827969484683203431057884917289334852774628366544173898461793872749381218755789561147579616430654545910443392999745646991166871881921220464939864253713908416530390190158949384932577913862830219713857369609459762011889417419756793122426703825117513400191620385907288504916090847305768659601562703145161353515226108384753106940659543471151834612884216177615674237258524708660356029782277496502661375640482568436495365098768844463148890142800375234779194361829383863910733638511522447466825092214583332860815273048698909839939639414519049464503518148811430663951050780377349263954109578307275120668187576579606920834997300457959369210342979008781474779797263684804038193343559153360000591890914138162679452520178353221126345668053628984789866309647708241703704572876397093327331829759682103901466789622570329436397304004981624979326705982863341122172795333419091029054076901225961700895404005870959370534342030325042659771283312708045031896875418423823654636664200180485341848613950104499288108479732463452304383581012867506699521685887270123864182790207674665585641962611326611636762153910224157810233669579162854801

if c < n:
    root, exact = integer_nth_root(c, e)
    if exact:
        m = root
        m_bytes = m.to_bytes((m.bit_length() + 7) // 8, 'big')
        print("Found m:", m)
        print("Plaintext:", m_bytes.decode('utf-8', errors='replace'))
    else:
        print("c is less than n but not a perfect e-th power.")
else:
    print("c >= n: ciphertext was reduced mod n; cannot get m by simple root.")
```

```
BLOODANGELIX-picoctf@webshell:~$ python script.py 
Found m: 2756326214127165272055984685514956805444646373265922995837
Plaintext: picoCTF{t1ny_e_af0d7666}
```

picoCTF{t1ny_e_af0d7666}

## Notas


## Referencia
